
/* View: MAG_ART, Owner: 1DR0GAT3 */

CREATE VIEW MAG_ART (
  CODICEARTICOLO, 
  CODICEMAGAZZINO, 
  DATADOCUMENTO, 
  TIPO, 
  GIACENZA, 
  ORDINATO, 
  IMPEGNATO
) AS

    SELECT R.CODICEARTICOLO, R.CODICEMAGAZZINO, R.DATADOCUMENTO, CAST('M' AS CHAR(1)) AS TIPO, COALESCE(R.MAG_QTA,0) AS GIACENZA, COALESCE(R.MAG_ORDINATO,0), COALESCE(R.MAG_IMPEGNATO,0)
    FROM RIGHIPRV AS R
    WHERE R.CODICEARTICOLO IS NOT NULL
    AND R.CODICEMAGAZZINO IS NOT NULL


    UNION ALL


    SELECT M.CODICEARTICOLO, M.CODICEMAGAZZINO, CAST('01/01/1900' AS TIMESTAMP), CAST('C' AS CHAR(1)) AS TIPO, COALESCE(M.GIACENZA,0), COALESCE(M.ORDINATO,0), COALESCE(M.IMPEGNATO,0)
    FROM MAGAZZINI AS M
;