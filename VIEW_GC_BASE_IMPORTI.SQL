/* 
   =================================================
   Vista che aggiunge alla vista di base dei prezzi di vendita
   gli importi al costo e alla vendita
   =================================================
*/

CREATE VIEW GC_BASE_IMPORTI
(
  /* ---------------------------------- */
  /* CAMPI PRESI DALLA VISTA PRECEDENTE */
  /* ---------------------------------- */
   TipoDocumento
  ,NumOrdPrev
  ,Registro
  ,DATADOCUMENTO
  ,PROGRIGO
  ,PROGRIGO2
  ,CAUSALE
  ,CODICECLIENTE

  ,PRATICA
  ,DATAPRATICA1
  ,DATACHIUSURAPRATICA1
  ,STATODESCRIZIONEPRATICA1
  ,RIFPRATICA
  ,CODSOGGPRAT
  ,PRAT_PRZUNITOPERA1_1
  ,PRAT_PRZUNITOPERA1_2
  ,PRAT_PRZUNITOPERA1_3
  ,PRAT_PRZUNITOPERA1_4
  ,PRAT_PRZUNITOPERA1_5
  ,PRAT_TIPORICARICO
  ,PRAT_TIPORICDACOMMESSA
  ,PRAT_RICARICOPERC
  ,PRAT_LISTINO
  ,OPERAINDEX
  ,OPERACODICE
  ,OPERADESCRIZIONE

  ,GUID
  ,GUID_REF
  ,GUID_ANCESTOR
  ,TRACK_PREVENTIVO
  ,TRACK_COMMESSA
  ,TRACK_DDT
  ,TRACK_FATTURA
  ,TRACK_ESTRATTO_CONTO
  ,TRACK_SAL
  ,TRACK_BOLLA_ENTR
  ,TRACK_FATT_ACQUI
  ,TRACK_ORD_FORN

  ,SEGNOOPERAZIONECANTIERE
  ,SEGNOOPERAZIONE
  ,GC_SEZIONE
  ,STATODESCRIZIONE
  ,STATOFOREGROUND

  ,DOCUMENTO
  ,SOGGETTO

  ,CodiceMagazzino
  ,MovMag
  ,CodiceArticolo
  ,Descrizione
  ,PrezzoUnitario
  ,UnitaDiMisura
  ,Qta
  ,ScontoRigo
  ,ScontoRigo2
  ,ScontoRigo3
  ,ImportoRigo
  ,PREZZOACQUISTOARTICOLO
  ,IMPORTOACQUISTOARTICOLO
  ,NOTERIGO
  ,MARGINE
  ,PREZZOUNITARIONETTO
  ,CodiceIVA
  ,DescrizioneIVA
  ,AliquotaIVA

  ,SOTTOCANTIERE1
  ,SOTTOCANTIERE2
  ,SOTTOCANTIERE3
  ,SOTTOCANTIERE4
  ,SOTTOCANTIERE5
  ,SOTTOCANTIERE6

  ,CATEGCANT1
  ,CATEGCANT2
  ,CATEGCANT3
  ,CATEGCANT4
  ,CATEGCANT5
  ,CATEGCANT6

  ,S3RIF
  ,S3UBICAZIONE
  ,S3COMPONENTE
  ,S3MATERIALE
  ,S3QTA
  ,S3DIAMETRO
  ,S3LUNGHEZZA
  ,S3INSTALLAZIONE
  ,S3CERTIFICAZIONE
  ,S3VENTILAZIONE
  ,S3SCARICO
  ,S3TIPO
  ,S3PORTATATERMICA
  ,S3TIPOCOLLEGAMENTO
  ,S3INSTALLATOINSTALLABILE
  ,S3MODELLO

  ,TIPOLOGIA

  ,GC_COSTONETTOUNITARIO_MOD
  ,GC_COSTONETTOUNITARIO
  ,GC_COSTONETTOIMPORTO

  ,GC_RICARICO_MOD
  ,GC_RICARICO

  ,GC_QTA_MOD
  ,GC_QTA

  ,GC_DESCRIZIONE_MOD
  ,GC_DESCRIZIONE

  ,GC_PRZVEND
  ,GC_PRESENTEINCOMMESSA
  ,GC_PRZVENDDACOMMESSA
  ,GC_PRZVENDIMPORTO
)

AS


/* =================================================
   |   VISTA BASE RIGHI                            |
   =================================================
*/
SELECT

  /* ---------------------------------- */
  /* CAMPI PRESI DALLA VISTA PRECEDENTE */
  /* ---------------------------------- */
   TipoDocumento
  ,NumOrdPrev
  ,Registro
  ,DATADOCUMENTO
  ,PROGRIGO
  ,PROGRIGO2
  ,CAUSALE
  ,CODICECLIENTE

  ,PRATICA
  ,DATAPRATICA1
  ,DATACHIUSURAPRATICA1
  ,STATODESCRIZIONEPRATICA1
  ,RIFPRATICA
  ,CODSOGGPRAT
  ,PRAT_PRZUNITOPERA1_1
  ,PRAT_PRZUNITOPERA1_2
  ,PRAT_PRZUNITOPERA1_3
  ,PRAT_PRZUNITOPERA1_4
  ,PRAT_PRZUNITOPERA1_5
  ,PRAT_TIPORICARICO
  ,PRAT_TIPORICDACOMMESSA
  ,PRAT_RICARICOPERC
  ,PRAT_LISTINO
  ,OPERAINDEX
  ,OPERACODICE
  ,OPERADESCRIZIONE

  ,GUID
  ,GUID_REF
  ,GUID_ANCESTOR
  ,TRACK_PREVENTIVO
  ,TRACK_COMMESSA
  ,TRACK_DDT
  ,TRACK_FATTURA
  ,TRACK_ESTRATTO_CONTO
  ,TRACK_SAL
  ,TRACK_BOLLA_ENTR
  ,TRACK_FATT_ACQUI
  ,TRACK_ORD_FORN

  ,SEGNOOPERAZIONECANTIERE
  ,SEGNOOPERAZIONE
  ,GC_SEZIONE
  ,STATODESCRIZIONE
  ,STATOFOREGROUND

  ,DOCUMENTO
  ,SOGGETTO

  ,CodiceMagazzino
  ,MovMag
  ,CodiceArticolo
  ,Descrizione
  ,PrezzoUnitario
  ,UnitaDiMisura
  ,Qta
  ,ScontoRigo
  ,ScontoRigo2
  ,ScontoRigo3
  ,ImportoRigo
  ,PREZZOACQUISTOARTICOLO
  ,IMPORTOACQUISTOARTICOLO
  ,NOTERIGO
  ,MARGINE
  ,PREZZOUNITARIONETTO
  ,CodiceIVA
  ,DescrizioneIVA
  ,AliquotaIVA

  ,SOTTOCANTIERE1
  ,SOTTOCANTIERE2
  ,SOTTOCANTIERE3
  ,SOTTOCANTIERE4
  ,SOTTOCANTIERE5
  ,SOTTOCANTIERE6

  ,CATEGCANT1
  ,CATEGCANT2
  ,CATEGCANT3
  ,CATEGCANT4
  ,CATEGCANT5
  ,CATEGCANT6

  ,S3RIF
  ,S3UBICAZIONE
  ,S3COMPONENTE
  ,S3MATERIALE
  ,S3QTA
  ,S3DIAMETRO
  ,S3LUNGHEZZA
  ,S3INSTALLAZIONE
  ,S3CERTIFICAZIONE
  ,S3VENTILAZIONE
  ,S3SCARICO
  ,S3TIPO
  ,S3PORTATATERMICA
  ,S3TIPOCOLLEGAMENTO
  ,S3INSTALLATOINSTALLABILE
  ,S3MODELLO

  ,TIPOLOGIA

  ,GC_COSTONETTOUNITARIO_MOD
  ,GC_COSTONETTOUNITARIO
  ,CAST(GC_COSTONETTOUNITARIO*GC_QTA AS NUMERIC(11,4))

  ,GC_RICARICO_MOD
  ,GC_RICARICO 

  ,GC_QTA_MOD
  ,GC_QTA

  ,GC_DESCRIZIONE_MOD
  ,GC_DESCRIZIONE

  ,GC_PRZVEND
  ,GC_PRESENTEINCOMMESSA
  ,GC_PRZVENDDACOMMESSA
  ,CAST(GC_PRZVEND*GC_QTA AS NUMERIC(11,4))

FROM GC_BASE_PRZVEND
