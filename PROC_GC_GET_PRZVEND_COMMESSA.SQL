CREATE PROCEDURE GC_GET_PRZVEND_COMMESSA (IN_COD_ART VARCHAR(25), IN_COD_CANT INTEGER, IN_DATA_CANT TIMESTAMP)
  RETURNS (OUTVAR DECIMAL(10,4))
AS
  DECLARE C CURSOR FOR (SELECT FIRST 1 IMPORTORIGO, COALESCE(QTA,0) FROM RIGHIPRV WHERE CODICEARTICOLO=:IN_COD_ART AND PRATICA=:IN_COD_CANT AND DATAPRATICA1=:IN_DATA_CANT AND SEGNOOPERAZIONECANTIERE='C');
  DECLARE VARIABLE loc_importorigo DOUBLE PRECISION;
  DECLARE VARIABLE loc_qta DOUBLE PRECISION;
BEGIN

  OPEN C;
  FETCH C INTO :loc_importorigo, :loc_qta;
  CLOSE C;

  IF (:loc_qta = 0) THEN BEGIN
    OUTVAR=NULL;
    SUSPEND;
    EXIT;
  END

  OUTVAR=:loc_importorigo/:loc_qta;
  IF (OUTVAR=0) THEN OUTVAR=NULL;
  SUSPEND;
  EXIT;

END