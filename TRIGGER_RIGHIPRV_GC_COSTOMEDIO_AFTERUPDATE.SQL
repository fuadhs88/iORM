CREATE TRIGGER RIGHIPRV_COSTOMEDIO_AFTERUPDATE FOR RIGHIPRV
ACTIVE AFTER UPDATE POSITION 0
AS
BEGIN
  IF (OLD.CODICEARTICOLO<>NEW.CODICEARTICOLO)
    THEN EXECUTE PROCEDURE GC_SET_COSTO_MEDIO_ARTICOLO (OLD.CODICEARTICOLO, OLD.PRATICA, OLD.DATAPRATICA1);

  IF (OLD.SEGNOOPERAZIONECANTIERE='+' OR NEW.SEGNOOPERAZIONECANTIERE='+')
    THEN EXECUTE PROCEDURE GC_SET_COSTO_MEDIO_ARTICOLO (NEW.CODICEARTICOLO, NEW.PRATICA, NEW.DATAPRATICA1);
END;
