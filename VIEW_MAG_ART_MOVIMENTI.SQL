
/* View: MAG_ART_MOVIMENTI, Owner: 1DR0GAT3 */

CREATE VIEW MAG_ART_MOVIMENTI (
  CODICEARTICOLO, 
  CODICEMAGAZZINO, 
  DATADOCUMENTO, 
  TIPO, 
  GIACENZA, 
  ORDINATO, 
  IMPEGNATO
) AS

    SELECT R.CODICEARTICOLO, R.CODICEMAGAZZINO, R.DATADOCUMENTO, CAST('M' AS CHAR(1)) AS TIPO, R.MAG_QTA, R.MAG_ORDINATO, R.MAG_IMPEGNATO
    FROM RIGHIPRV AS R
    WHERE R.CODICEARTICOLO IS NOT NULL
    AND R.CODICEMAGAZZINO IS NOT NULL


    UNION ALL


    SELECT M.CODICEARTICOLO, M.CODICEMAGAZZINO, DATACHIUSURA, CAST('C' AS CHAR(1)) AS TIPO, M.GIACENZA, M.ORDINATO, M.IMPEGNATO
    FROM MAGAZZINI AS M
;