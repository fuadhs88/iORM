
/* View: DOC_LIST_VIEW, Owner: 1DR0GAT3 */

CREATE VIEW DOC_LIST_VIEW (
  ID,
  IS_LDE,
  TIPODOC, 
  REGISTRO, 
  CODICEDOC, 
  DATADOC, 
  OGGETTOJOLLY1, 
  OGGETTOJOLLY2, 
  OGGETTOJOLLY3, 
  IMPORTO, 
  NOTEJOLLY1, 
  NOTEJOLLY2,
  CLIENTEFORNITORE, 
  OGGETTO, 
  NOTE, 
  MESSAGGI, 
  STATODESCRIZIONE, 
  STATOFOREGROUND, 
  STATOBACKGROUND, 
  SELEZIONATO, 
  PROVENIENZA, 
  ARGOMENTO, 
  IMPONIBILE, 
  IMPORTOIVA, 
  CODICESOGGETTO, 
  ORADOC, 
  DAFATTURARE, 
  RIFPRATICA, 
  VALIDITADATA, 
  CONSEGNADATA, 
  CONSEGNATO, 
  CAUSALE, 
  CAUSALECANTIERE, 
  RITENUTAACCONTO, 
  TIPOSOGGETTO, 
  OPERATORE, 
  OPERATOREULTMOD_ULTMOD,
  DATAORAULTMOD_CREAZIONE,
  DATAORAULTMOD_ULTMOD,
  RAGSOCCLI, 
  RAGSOCDESTMERCI, 
  CODICECLIENTE, 
  RIFSOGG1_CODICE, 
  RIFSOGG2_CODICE, 
  RIFSOGG3_CODICE, 
  RIFSOGG4_CODICE, 
  RIFSOGG5_CODICE, 
  RIFSOGG6_CODICE, 
  RIFSOGG7_CODICE, 
  RIFSOGG8_CODICE, 
  RIFSOGG9_CODICE, 
  RIFSOGG10_CODICE, 
  RIFSOGG1_RAGIONESOCIALE, 
  RIFSOGG2_RAGIONESOCIALE, 
  RIFSOGG3_RAGIONESOCIALE, 
  RIFSOGG4_RAGIONESOCIALE, 
  RIFSOGG5_RAGIONESOCIALE, 
  RIFSOGG6_RAGIONESOCIALE, 
  RIFSOGG7_RAGIONESOCIALE, 
  RIFSOGG8_RAGIONESOCIALE, 
  RIFSOGG9_RAGIONESOCIALE, 
  RIFSOGG10_RAGIONESOCIALE, 
  PRATICA, 
  DATAPRATICA1, 
  PRATICA2, 
  DATAPRATICA2, 
  PRATICA3, 
  DATAPRATICA3, 
  AGENTE, 
  AGENTE2, 
  AGENTE3, 
  AGENTE4, 
  AZIONECANTIERE, 
  AZIONEMAGAZZINO,
  EXPORTED,
  PROTOCOLLO,
  PROTOCOLLO_DATA,
  CATEGCANT1,
  CATEGCANT2,
  CATEGCANT3,
  CATEGCANT4,
  CATEGCANT5,
  CATEGCANT6,
  EXISTS_CORRISPNOPAG,
  CODICESUBSOGG,
  SUBSOGGCAMPO1,
  SUBSOGGCAMPO2,
  SUBSOGGCAMPO3,
  SUBSOGGCAMPO4,
  RIFDOC_TIPO,
  RIFDOC_NUM,
  RIFDOC_REG,
  RIFDOC_DATA,
  RIFDOC_CORRISPNOPAG,
  PARTITAIVA,
  CODICEFISCALE,
  DESTINAZIONEMERCI,
  PAGAMENTO,
  FE_ID,
  FE_STATUS,
  FE_LASTNOTIFICATION,
  FE_CHECKFORNOTIFICATIONS,
  FE_NOTIFICATIONWAITDAYS,
  TIPOPERSONA,
  JOLLY_NUM_1,
  RESOURCENAME,
  APPARECCHI,
  TIPODOCESTESO,
  RDA,
  ABBUONO,
  TOTALEDAPAGARE,
  TOTALESPLITPAYMENT,
  DATIVETTORE
) AS

/*======================================================
SEZIONE DOCUMENTI: PRVORDCL
======================================================*/
SELECT
 CAST(NULL AS INTEGER) AS ID
,CAST('F' AS CHAR(1)) AS IS_LDE
,CAST(Doc.TipoDocumento AS VARCHAR(20)) AS TIPODOC
,CAST(Doc.Registro AS VARCHAR(5)) AS REGISTRO
,CAST(Doc.NumOrdPrev AS INTEGER) AS CODICEDOC
,CAST(Doc.DataDocumento AS TIMESTAMP) AS DATADOC
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY1
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY2
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY3
,CAST(COALESCE(   (CASE WHEN (Doc.TipoDocumento='Nota_accre' OR Doc.TipoDocumento='N.C.fornit') THEN 0-Doc.TotaleDocumento ELSE Doc.TotaleDocumento END)   ,0) AS DECIMAL(15,4)) AS IMPORTO
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY1
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY2
,CAST(  SUBSTRING(  Cli.RagioneSociale || '  (' || Doc.CodiceCliente || ')'  FROM 1 FOR 80) AS VARCHAR(80)) AS CLIENTEFORNITORE
,CAST(
  CASE
    WHEN (DOC.TIPODOCUMENTO = 'Intervento') THEN (SELECT FIRST 1 COALESCE(I.RELAZIONEINTERVENTO || '   ','') || '(' || COALESCE(I.EVENTMESSAGE || ' - ', '') || COALESCE(I.LOCATION, '') || ')' FROM IMPEGNI I WHERE I.ID=DOC.NUMORDPREV)
    ELSE ''
  END
 AS VARCHAR(5000)) AS OGGETTO
,CAST(DOC.NOTE AS VARCHAR(5000)) AS NOTE
,CAST(DOC.MESSAGGI AS VARCHAR(5000)) AS MESSAGGI
,CAST(Doc.StatoDescrizione AS VARCHAR(10)) AS STATODESCRIZIONE
,CAST(Doc.StatoForeground AS VARCHAR(10)) AS STATOFOREGROUND
,CAST(Doc.StatoBackground AS VARCHAR(10)) AS STATOBACKGROUND
,CAST(Doc.Selezionato AS VARCHAR(1)) AS SELEZIONATO
,CAST('' AS VARCHAR(200)) AS PROVENIENZA
,CAST(Doc.Argomento AS VARCHAR(200)) AS ARGOMENTO
,CAST(COALESCE(   (CASE WHEN (Doc.TipoDocumento='Nota_accre' OR Doc.TipoDocumento='N.C.fornit') THEN 0-Doc.TotaleImponibile1-Doc.TotaleImponibile2-Doc.TotaleImponibile3-Doc.TotaleImponibile4 ELSE Doc.TotaleImponibile1+Doc.TotaleImponibile2+Doc.TotaleImponibile3+Doc.TotaleImponibile4 END)   ,0) AS DECIMAL(15,4)) AS IMPONIBILE
,CAST(COALESCE(   (CASE WHEN (Doc.TipoDocumento='Nota_accre' OR Doc.TipoDocumento='N.C.fornit') THEN 0-Doc.ImportoIVA1-Doc.ImportoIVA2-Doc.ImportoIVA3-Doc.ImportoIVA4 ELSE Doc.ImportoIVA1+Doc.ImportoIVA2+Doc.ImportoIVA3+Doc.ImportoIVA4 END)   ,0) AS DECIMAL(15,4)) AS IMPORTOIVA
,CAST(Doc.CodiceCliente AS INTEGER) AS CODICESOGGETTO
,CAST('' AS VARCHAR(8)) AS ORADOC
,CAST(Doc.DaFatturare AS VARCHAR(1)) AS DAFATTURARE
,CAST(  SUBSTRING(  PRAT.DESCRIZIONE ||'  ('||DOC.PRATICA|| ', '||DOC.DATAPRATICA1||')'  FROM 1 FOR 120) AS VARCHAR(120)) AS RIFPRATICA
,CAST(Doc.ValiditaData AS TIMESTAMP) AS VALIDITADATA
,CAST(Doc.ConsegnaData AS TIMESTAMP) AS CONSEGNADATA
,CAST(Doc.Consegnato AS CHAR(1)) AS CONSEGNATO
,CAST(Doc.Causale AS VARCHAR(40)) AS CAUSALE
,CAST(Doc.CausaleCantiere AS VARCHAR(15)) AS CAUSALECANTIERE
,CAST(COALESCE(Doc.RitAcc,0) AS DECIMAL(15,4)) AS RITENUTAACCONTO
,CAST(Cli.ClienteFornitore AS VARCHAR(10)) AS TIPOSOGGETTO
,CAST(Doc.Operatore AS VARCHAR(10)) AS OPERATORE
,CAST(Doc.OPERATOREULTMOD_ULTMOD AS VARCHAR(10)) AS OPERATOREULTMOD_ULTMOD
,CAST(Doc.DATAULTMOD_CREAZIONE AS TIMESTAMP) AS DATAULTMOD_CREAZIONE
,CAST(Doc.DATAULTMOD_ULTMOD AS TIMESTAMP) AS DATAULTMOD_ULTMOD
,CAST(Doc.RagSocCli AS VARCHAR(60)) AS RAGSOCCLI
,CAST(Doc.RagSocDestMerci AS VARCHAR(60)) AS RAGSOCDESTMERCI
,CAST(Doc.CodiceCliente AS INTEGER) AS CODICECLIENTE
,CAST(Doc.RIFSOGG1_CODICE AS INTEGER) AS RIFSOGG1_CODICE
,CAST(Doc.RIFSOGG2_CODICE AS INTEGER) AS RIFSOGG2_CODICE
,CAST(Doc.RIFSOGG3_CODICE AS INTEGER) AS RIFSOGG3_CODICE
,CAST(Doc.RIFSOGG4_CODICE AS INTEGER) AS RIFSOGG4_CODICE
,CAST(Doc.RIFSOGG5_CODICE AS INTEGER) AS RIFSOGG5_CODICE
,CAST(Doc.RIFSOGG6_CODICE AS INTEGER) AS RIFSOGG6_CODICE
,CAST(Doc.RIFSOGG7_CODICE AS INTEGER) AS RIFSOGG7_CODICE
,CAST(Doc.RIFSOGG8_CODICE AS INTEGER) AS RIFSOGG8_CODICE
,CAST(Doc.RIFSOGG9_CODICE AS INTEGER) AS RIFSOGG9_CODICE
,CAST(Doc.RIFSOGG10_CODICE AS INTEGER) AS RIFSOGG10_CODICE
,CAST(Doc.RIFSOGG1_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG1_RAGIONESOCIALE
,CAST(Doc.RIFSOGG2_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG2_RAGIONESOCIALE
,CAST(Doc.RIFSOGG3_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG3_RAGIONESOCIALE
,CAST(Doc.RIFSOGG4_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG4_RAGIONESOCIALE
,CAST(Doc.RIFSOGG5_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG5_RAGIONESOCIALE
,CAST(Doc.RIFSOGG6_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG6_RAGIONESOCIALE
,CAST(Doc.RIFSOGG7_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG7_RAGIONESOCIALE
,CAST(Doc.RIFSOGG8_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG8_RAGIONESOCIALE
,CAST(Doc.RIFSOGG9_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG9_RAGIONESOCIALE
,CAST(Doc.RIFSOGG10_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOG10_RAGIONESOCIALE
,CAST(Doc.Pratica AS INTEGER) AS PRATICA
,CAST(Doc.DATAPRATICA1 AS TIMESTAMP) AS DATAPRATICA1
,CAST(Doc.Pratica2 AS INTEGER) AS PRATICA2
,CAST(Doc.DATAPRATICA2 AS TIMESTAMP) AS DATAPRATICA2
,CAST(Doc.Pratica3 AS INTEGER) AS PRATICA3
,CAST(Doc.DATAPRATICA3 AS TIMESTAMP) AS DATAPRATICA3
,CAST(Doc.AGENTE AS VARCHAR(25)) AS AGENTE
,CAST(Doc.AGENTE2 AS VARCHAR(25)) AS AGENTE2
,CAST(Doc.AGENTE3 AS VARCHAR(25)) AS AGENTE3
,CAST(Doc.AGENTE4 AS VARCHAR(25)) AS AGENTE4
,CAST(Doc.SEGNOOPERAZIONECANTIERE AS CHAR(1)) AS AZIONECANTIERE
,CAST(Doc.SEGNOOPERAZIONE AS CHAR(1)) AS AZIONEMAGAZZINO
,CAST(Doc.EXPORTED AS CHAR(1)) AS EXPORTED
,Doc.PROTOCOLLO
,Doc.PROTOCOLLO_DATA
,PRAT.CATEGCANT1
,PRAT.CATEGCANT2
,PRAT.CATEGCANT3
,PRAT.CATEGCANT4
,PRAT.CATEGCANT5
,PRAT.CATEGCANT6
,Doc.RIFDOC_CORRISPNOPAG
,DOC.CODICESUBSOGG
,DOC.SUBSOGGCAMPO1
,DOC.SUBSOGGCAMPO2
,DOC.SUBSOGGCAMPO3
,SS.CAMPO4 AS SUBSOGGCAMPO4
,DOC.RIFDOC_TIPO
,DOC.RIFDOC_NUM
,DOC.RIFDOC_REG
,CAST(   extract(month from DOC.RIFDOC_DATA) ||'/'|| extract(day from DOC.RIFDOC_DATA) ||'/'|| extract(year from DOC.RIFDOC_DATA) AS TIMESTAMP) AS RIFDOC_DATA
,DOC.RIFDOC_CORRISPNOPAG
,CLI.PARTITAIVA
,CLI.CODICEFISCALE
,CAST(   SUBSTRING(  COALESCE(DOC.RAGSOCDESTMERCI || ' - ','') || COALESCE(DOC.INDIRIZZODESTMERCI || ' ','') || COALESCE(DOC.NUMCIVICODESTMERCI || ' ','') || COALESCE(DOC.CITTADESTMERCI || ' ','') || COALESCE('- ' || DOC.PROVINCIADESTMERCI || ' ','') || COALESCE('- ' || DOC.CAPDESTMERCI,'') || COALESCE(' (' || DOC.CODICEDESTMERCI || ')','')  FROM 1 FOR 250)  AS VARCHAR(250)) AS DESTINAZIONEMERCI
,CAST(   (SELECT PAGAM.DESCRIZIONE FROM PAGAM WHERE PAGAM.CODICE = Doc.PAGAMENTO)   AS VARCHAR(40)) AS PAGAMENTO 
,DOC.FE_ID
,DOC.FE_STATUS
,DOC.FE_LASTNOTIFICATION
,DOC.FE_CHECKFORNOTIFICATIONS
,DOC.FE_NOTIFICATIONWAITDAYS
,CLI.TIPOPERSONA
,DOC.JOLLY_NUM_1
,CAST(   CASE WHEN(Doc.TipoDocumento = 'Intervento') THEN (SELECT Tecnici.ResourceName FROM Impegni LEFT OUTER JOIN Tecnici ON (Tecnici.ResourceID = Impegni.ResourceID) WHERE Impegni.ID = Doc.NumOrdPrev) ELSE '' END   AS VARCHAR(255)) AS ResourceName
,CAST(   CASE WHEN(Doc.TipoDocumento = 'Intervento') THEN (SELECT OUTVAL FROM IMPEGNI_GETAPPARECCHI(DOC.NUMORDPREV)) ELSE NULL END AS VARCHAR(255)) AS APPARECCHI
,DOC.TIPODOCUMENTOESTESO AS TIPODOCESTESO
,I.RDA AS RDA
,CAST(COALESCE(   (CASE WHEN (Doc.TipoDocumento='Nota_accre' OR Doc.TipoDocumento='N.C.fornit') THEN Doc.Abbuono ELSE 0-Doc.Abbuono END)   ,0) AS DECIMAL(15,4)) AS ABBUONO
,CAST(COALESCE(   (CASE WHEN (Doc.TipoDocumento='Nota_accre' OR Doc.TipoDocumento='N.C.fornit') THEN 0-Doc.TotaleDaPagare ELSE Doc.TotaleDaPagare END)   ,0) AS DECIMAL(15,4)) AS TotaleDaPagare
,CAST(  (CASE WHEN (Doc.SplitPayment = 'S') THEN COALESCE(Doc.TotaleIVA,0) ELSE 0 END)  AS DECIMAL(15,4)) AS TOTALESPLITPAYMENT
,CAST(DOC.DATIVETTORE AS VARCHAR(50)) AS DATIVETTORE
FROM PrvOrdCl Doc
LEFT JOIN CLIENTI CLI ON (CLI.CODICE = DOC.CODICECLIENTE)
LEFT JOIN PRATICHE PRAT ON (PRAT.CODICE=DOC.PRATICA AND PRAT.DATAAPERTURA=DOC.DATAPRATICA1)
LEFT JOIN SUBSOGG SS ON (SS.CODICE=DOC.CODICESUBSOGG)
LEFT JOIN IMPEGNI I ON (DOC.TIPODOCUMENTO='Intervento' AND I.ID=DOC.NUMORDPREV)
/* ================================================== */
UNION ALL
/*======================================================
SEZIONE DOCUMENTI ESTERNI: EXTFILE
======================================================*/
SELECT
 CAST(NULL AS INTEGER) AS ID
,CAST('F' AS CHAR(1)) AS IS_LDE
,CAST('Doc.esterno' AS VARCHAR(20)) AS TIPODOC
,CAST(Doc.Registro AS VARCHAR(5)) AS REGISTRO
,CAST(Doc.Codice AS INTEGER) AS CODICEDOC
,CAST(Doc.Data AS TIMESTAMP) AS DATADOC
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY1
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY2
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY3
,CAST(0 AS DECIMAL(15,4)) AS IMPORTO
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY1
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY2
,CAST(  SUBSTRING(  Cli.RagioneSociale || '  (' || Doc.Cliente || ')'  FROM 1 FOR 80) AS VARCHAR(80)) AS CLIENTEFORNITORE
,CAST(Doc.Oggetto AS VARCHAR(5000)) AS OGGETTO
,CAST(Doc.Note AS VARCHAR(5000)) AS NOTE
,CAST('' AS VARCHAR(5000)) AS MESSAGGI
,CAST(Doc.StatoDescrizione AS VARCHAR(10)) AS STATODESCRIZIONE
,CAST(Doc.StatoForeground AS VARCHAR(10)) AS STATOFOREGROUND
,CAST(Doc.StatoBackground AS VARCHAR(10)) AS STATOBACKGROUND
,CAST('' AS VARCHAR(1)) AS SELEZIONATO
,CAST(Doc.Provenienza AS VARCHAR(200)) AS PROVENIENZA
,CAST(Doc.Argomento AS VARCHAR(200)) AS ARGOMENTO
,CAST(0 AS DECIMAL(15,4)) AS IMPONIBILE
,CAST(0 AS DECIMAL(15,4)) AS IMPORTOIVA
,CAST(Doc.Cliente AS INTEGER) AS CODICESOGGETTO
,CAST('' AS VARCHAR(8)) AS ORADOC
,CAST('' AS VARCHAR(1)) AS DAFATTURARE
,CAST(  SUBSTRING(  PRAT.DESCRIZIONE ||'  ('||DOC.PRATICA|| ', '||DOC.DATAPRATICA1||')'  FROM 1 FOR 120) AS VARCHAR(120)) AS RIFPRATICA
,CAST(NULL AS TIMESTAMP) AS VALIDITADATA
,CAST(NULL AS TIMESTAMP) AS CONSEGNADATA
,CAST(NULL AS CHAR(1)) AS CONSEGNATO
,CAST(NULL AS VARCHAR(40)) AS CAUSALE
,CAST(NULL AS VARCHAR(15)) AS CAUSALECANTIERE
,CAST(0 AS DECIMAL(15,4)) AS RITENUTAACCONTO
,CAST(Cli.ClienteFornitore AS VARCHAR(10)) AS TIPOSOGGETTO
,CAST('' AS VARCHAR(10)) AS OPERATORE
,CAST('' AS VARCHAR(10)) AS OPERATOREULTMOD_ULTMOD
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_CREAZIONE
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_ULTMOD
,CAST(Doc.RagSocCli AS VARCHAR(60)) AS RAGSOCCLI
,CAST(NULL AS VARCHAR(60)) AS RAGSOCDESTMERCI
,CAST(Doc.Cliente AS INTEGER) AS CODICECLIENTE
,CAST(Doc.RIFSOGG1_CODICE AS INTEGER) AS RIFSOGG1_CODICE
,CAST(Doc.RIFSOGG2_CODICE AS INTEGER) AS RIFSOGG2_CODICE
,CAST(Doc.RIFSOGG3_CODICE AS INTEGER) AS RIFSOGG3_CODICE
,CAST(Doc.RIFSOGG4_CODICE AS INTEGER) AS RIFSOGG4_CODICE
,CAST(Doc.RIFSOGG5_CODICE AS INTEGER) AS RIFSOGG5_CODICE
,CAST(Doc.RIFSOGG6_CODICE AS INTEGER) AS RIFSOGG6_CODICE
,CAST(Doc.RIFSOGG7_CODICE AS INTEGER) AS RIFSOGG7_CODICE
,CAST(Doc.RIFSOGG8_CODICE AS INTEGER) AS RIFSOGG8_CODICE
,CAST(Doc.RIFSOGG9_CODICE AS INTEGER) AS RIFSOGG9_CODICE
,CAST(Doc.RIFSOGG10_CODICE AS INTEGER) AS RIFSOGG10_CODICE
,CAST(Doc.RIFSOGG1_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG1_RAGIONESOCIALE
,CAST(Doc.RIFSOGG2_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG2_RAGIONESOCIALE
,CAST(Doc.RIFSOGG3_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG3_RAGIONESOCIALE
,CAST(Doc.RIFSOGG4_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG4_RAGIONESOCIALE
,CAST(Doc.RIFSOGG5_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG5_RAGIONESOCIALE
,CAST(Doc.RIFSOGG6_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG6_RAGIONESOCIALE
,CAST(Doc.RIFSOGG7_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG7_RAGIONESOCIALE
,CAST(Doc.RIFSOGG8_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG8_RAGIONESOCIALE
,CAST(Doc.RIFSOGG9_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOGG9_RAGIONESOCIALE
,CAST(Doc.RIFSOGG10_RAGIONESOCIALE AS VARCHAR(60)) AS RIFSOG10_RAGIONESOCIALE
,CAST(Doc.Pratica AS INTEGER) AS PRATICA
,CAST(Doc.DATAPRATICA1 AS TIMESTAMP) AS DATAPRATICA1
,CAST(Doc.Pratica2 AS INTEGER) AS PRATICA2
,CAST(Doc.DATAPRATICA2 AS TIMESTAMP) AS DATAPRATICA2
,CAST(Doc.Pratica3 AS INTEGER) AS PRATICA3
,CAST(Doc.DATAPRATICA3 AS TIMESTAMP) AS DATAPRATICA3
,CAST(Doc.AGENTE AS VARCHAR(25)) AS AGENTE
,CAST(Doc.AGENTE2 AS VARCHAR(25)) AS AGENTE2
,CAST(Doc.AGENTE3 AS VARCHAR(25)) AS AGENTE3
,CAST(Doc.AGENTE4 AS VARCHAR(25)) AS AGENTE4
,CAST(NULL AS CHAR(1)) AS AZIONECANTIERE
,CAST(NULL AS CHAR(1)) AS AZIONEMAGAZZINO
,CAST(NULL AS CHAR(1)) AS EXPORTED
,CAST(NULL AS INTEGER) AS PROTOCOLLO
,CAST(NULL AS TIMESTAMP) AS PROTOCOLLO
,PRAT.CATEGCANT1
,PRAT.CATEGCANT2
,PRAT.CATEGCANT3
,PRAT.CATEGCANT4
,PRAT.CATEGCANT5
,PRAT.CATEGCANT6
,CAST(NULL AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CAST(NULL AS INTEGER) AS CODICESUBSOGG
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO1
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO2
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO3
,CAST(NULL AS TIMESTAMP) AS SUBSOGGCAMPO4
,CAST(null AS VARCHAR(25)) AS RIFDOC_TIPO
,CAST(null AS INTEGER) AS RIFDOC_NUM
,CAST(null AS VARCHAR(5)) AS RIFDOC_REG
,CAST(null AS TIMESTAMP) AS RIFDOC_DATA
,CAST(null AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CLI.PARTITAIVA
,CLI.CODICEFISCALE
,CAST('' AS VARCHAR(250)) AS DESTINAZIONEMERCI
,CAST('' AS VARCHAR(40)) AS PAGAMENTO
,CAST(NULL AS VARCHAR(250)) AS FE_ID
,CAST(NULL AS VARCHAR(30)) AS FE_STATUS
,CAST(NULL AS TIMESTAMP) AS FE_LASTNOTIFICATION
,CAST(NULL AS CHAR(1)) AS FE_CHECKFORNOTIFICATIONS
,CAST(NULL AS INTEGER) AS FE_NOTIFICATIONWAITDAYS
,CLI.TIPOPERSONA
,CAST(0 AS DECIMAL(15,4)) AS JOLLY_NUM_1
,CAST('' AS VARCHAR(255)) AS RESOURCENAME
,CAST(NULL AS VARCHAR(255)) AS APPARECCHI
,CAST('Documento esterno' AS VARCHAR(25)) AS TIPODOCESTESO
,CAST(NULL AS VARCHAR(20)) AS RDA
,CAST(0 AS DECIMAL(15,4)) AS ABBUONO
,CAST(0 AS DECIMAL(15,4)) AS TOTALEDAPAGARE
,CAST(0 AS DECIMAL(15,4)) AS TOTALESPLITPAYMENT
,CAST(NULL AS VARCHAR(50)) AS DATIVETTORE
FROM ExtFile Doc
LEFT JOIN CLIENTI CLI ON (CLI.CODICE = DOC.CLIENTE)
LEFT JOIN PRATICHE PRAT ON (PRAT.CODICE=DOC.PRATICA AND PRAT.DATAAPERTURA=DOC.DATAPRATICA1)
/* ================================================== */
UNION ALL
/*======================================================
SEZIONE TESTI: TESTI
======================================================*/
SELECT
 CAST(NULL AS INTEGER) AS ID
,CAST('F' AS CHAR(1)) AS IS_LDE
,CAST('Lettera' AS VARCHAR(20)) AS TIPODOC
,CAST('' AS VARCHAR(5)) AS REGISTRO
,CAST(Doc.Codice AS INTEGER) AS CODICEDOC
,CAST(Doc.Data AS TIMESTAMP) AS DATADOC
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY1
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY2
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY3
,CAST(0 AS DECIMAL(15,4)) AS IMPORTO
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY1
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY2
,CAST(  SUBSTRING(  Cli.RagioneSociale || '  (' || Doc.Cliente || ')'  FROM 1 FOR 80) AS VARCHAR(80)) AS CLIENTEFORNITORE
,CAST(Doc.Oggetto AS VARCHAR(5000)) AS OGGETTO
,CAST(Doc.Note AS VARCHAR(5000)) AS NOTE
,CAST('' AS VARCHAR(5000)) AS MESSAGGI
,CAST(Doc.StatoDescrizione AS VARCHAR(10)) AS STATODESCRIZIONE
,CAST(Doc.StatoForeground AS VARCHAR(10)) AS STATOFOREGROUND
,CAST(Doc.StatoBackground AS VARCHAR(10)) AS STATOBACKGROUND
,CAST('' AS VARCHAR(1)) AS SELEZIONATO
,CAST(Doc.Provenienza AS VARCHAR(200)) AS PROVENIENZA
,CAST(Doc.Argomento AS VARCHAR(200)) AS ARGOMENTO
,CAST(0 AS DECIMAL(15,4)) AS IMPONIBILE
,CAST(0 AS DECIMAL(15,4)) AS IMPORTOIVA
,CAST(Doc.Cliente AS INTEGER) AS CODICESOGGETTO
,CAST('' AS VARCHAR(8)) AS ORADOC
,CAST('' AS VARCHAR(1)) AS DAFATTURARE
,CAST(  SUBSTRING(  PRAT.DESCRIZIONE ||'  ('||DOC.PRATICA|| ', '||DOC.DATAPRATICA1||')'  FROM 1 FOR 120) AS VARCHAR(120)) AS RIFPRATICA
,CAST(NULL AS TIMESTAMP) AS VALIDITADATA
,CAST(NULL AS TIMESTAMP) AS CONSEGNADATA
,CAST(NULL AS CHAR(1)) AS CONSEGNATO
,CAST(NULL AS VARCHAR(40)) AS CAUSALE
,CAST(NULL AS VARCHAR(15)) AS CAUSALECANTIERE
,CAST(0 AS DECIMAL(15,4)) AS RITENUTAACCONTO
,CAST(Cli.ClienteFornitore AS VARCHAR(10)) AS TIPOSOGGETTO
,CAST('' AS VARCHAR(10)) AS OPERATORE
,CAST('' AS VARCHAR(10)) AS OPERATOREULTMOD_ULTMOD
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_CREAZIONE
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_ULTMOD
,CAST(Doc.RagSocCli AS VARCHAR(60)) AS RAGSOCCLI
,CAST(NULL AS VARCHAR(60)) AS RAGSOCDESTMERCI
,CAST(Doc.Cliente AS INTEGER) AS CODICECLIENTE
,CAST(NULL AS INTEGER) AS RIFSOGG1_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG2_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG3_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG4_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG5_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG6_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG7_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG8_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG9_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG10_CODICE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG1_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG2_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG3_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG4_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG5_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG6_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG7_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG8_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG9_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG10_RAGIONESOCIALE
,CAST(Doc.Pratica AS INTEGER) AS PRATICA
,CAST(Doc.DATAPRATICA1 AS TIMESTAMP) AS DATAPRATICA1
,CAST(Doc.Pratica2 AS INTEGER) AS PRATICA2
,CAST(Doc.DATAPRATICA2 AS TIMESTAMP) AS DATAPRATICA2
,CAST(Doc.Pratica3 AS INTEGER) AS PRATICA3
,CAST(Doc.DATAPRATICA3 AS TIMESTAMP) AS DATAPRATICA3
,CAST(NULL AS VARCHAR(25)) AS AGENTE
,CAST(NULL AS VARCHAR(25)) AS AGENTE2
,CAST(NULL AS VARCHAR(25)) AS AGENTE3
,CAST(NULL AS VARCHAR(25)) AS AGENTE4
,CAST(NULL AS CHAR(1)) AS AZIONECANTIERE
,CAST(NULL AS CHAR(1)) AS AZIONEMAGAZZINO
,CAST(NULL AS CHAR(1)) AS EXPORTED
,CAST(NULL AS INTEGER) AS PROTOCOLLO
,CAST(NULL AS TIMESTAMP) AS PROTOCOLLO
,PRAT.CATEGCANT1
,PRAT.CATEGCANT2
,PRAT.CATEGCANT3
,PRAT.CATEGCANT4
,PRAT.CATEGCANT5
,PRAT.CATEGCANT6
,CAST(NULL AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CAST(NULL AS INTEGER) AS CODICESUBSOGG
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO1
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO2
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO3
,CAST(NULL AS TIMESTAMP) AS SUBSOGGCAMPO4
,CAST(null AS VARCHAR(25)) AS RIFDOC_TIPO
,CAST(null AS INTEGER) AS RIFDOC_NUM
,CAST(null AS VARCHAR(5)) AS RIFDOC_REG
,CAST(null AS TIMESTAMP) AS RIFDOC_DATA
,CAST(null AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CLI.PARTITAIVA
,CLI.CODICEFISCALE
,CAST('' AS VARCHAR(250)) AS DESTINAZIONEMERCI
,CAST('' AS VARCHAR(40)) AS PAGAMENTO
,CAST(NULL AS VARCHAR(250)) AS FE_ID
,CAST(NULL AS VARCHAR(30)) AS FE_STATUS
,CAST(NULL AS TIMESTAMP) AS FE_LASTNOTIFICATION
,CAST(NULL AS CHAR(1)) AS FE_CHECKFORNOTIFICATIONS
,CAST(NULL AS INTEGER) AS FE_NOTIFICATIONWAITDAYS
,CLI.TIPOPERSONA
,CAST(0 AS DECIMAL(15,4)) AS JOLLY_NUM_1
,CAST('' AS VARCHAR(255)) AS RESOURCENAME
,CAST(NULL AS VARCHAR(255)) AS APPARECCHI
,CAST('Lettera' AS VARCHAR(25)) AS TIPODOCESTESO
,CAST(NULL AS VARCHAR(20)) AS RDA
,CAST(0 AS DECIMAL(15,4)) AS ABBUONO
,CAST(0 AS DECIMAL(15,4)) AS TOTALEDAPAGARE
,CAST(0 AS DECIMAL(15,4)) AS TOTALESPLITPAYMENT
,CAST(NULL AS VARCHAR(50)) AS DATIVETTORE
FROM Testi Doc
LEFT JOIN CLIENTI CLI ON (CLI.CODICE = DOC.CLIENTE)
LEFT JOIN PRATICHE PRAT ON (PRAT.CODICE=DOC.PRATICA AND PRAT.DATAAPERTURA=DOC.DATAPRATICA1)
/* ================================================== */
UNION ALL
/*======================================================
SEZIONE CONFORMITA (NUOVE): LDE_DOCUMENTI
======================================================*/
SELECT
 CAST(Doc.ID AS INTEGER) AS ID
,CAST('T' AS CHAR(1)) AS IS_LDE
,CAST(Doc.Tipo AS VARCHAR(20)) AS TIPODOC
,CAST(Doc.REGISTRO AS VARCHAR(5)) AS REGISTRO
,CAST(Doc.NUMERO AS INTEGER) AS CODICEDOC
,CAST(Doc.DATA AS TIMESTAMP) AS DATADOC
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY1
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY2
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY3
,CAST(0 AS DECIMAL(15,4)) AS IMPORTO
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY1
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY2
,CAST(  SUBSTRING(Cli.RagioneSociale || '  (' || Doc.SOGGETTO || ')'  FROM 1 FOR 80) AS VARCHAR(80)) AS CLIENTEFORNITORE
,CAST(Doc.OGGETTO AS VARCHAR(5000)) AS OGGETTO
,CAST(Doc.NOTE AS VARCHAR(5000)) AS NOTE
,CAST('' AS VARCHAR(5000)) AS MESSAGGI
,CAST(Doc.StatoDescrizione AS VARCHAR(10)) AS STATODESCRIZIONE
,CAST(Doc.StatoForeground AS VARCHAR(10)) AS STATOFOREGROUND
,CAST(Doc.StatoBackground AS VARCHAR(10)) AS STATOBACKGROUND
,CAST('' AS VARCHAR(1)) AS SELEZIONATO
,CAST('' AS VARCHAR(200)) AS PROVENIENZA
,CAST('' AS VARCHAR(200)) AS ARGOMENTO
,CAST(0 AS DECIMAL(15,4)) AS IMPONIBILE
,CAST(0 AS DECIMAL(15,4)) AS IMPORTOIVA
,CAST(Doc.SOGGETTO AS INTEGER) AS CODICESOGGETTO
,CAST('' AS VARCHAR(8)) AS ORADOC
,CAST('' AS VARCHAR(1)) AS DAFATTURARE
,CAST(  SUBSTRING(  PRAT.DESCRIZIONE ||'  ('||PRAT.CODICE|| ', '||PRAT.DATAAPERTURA||')'  FROM 1 FOR 120) AS VARCHAR(120)) AS RIFPRATICA
,CAST(NULL AS TIMESTAMP) AS VALIDITADATA
,CAST(NULL AS TIMESTAMP) AS CONSEGNADATA
,CAST(NULL AS CHAR(1)) AS CONSEGNATO
,CAST(NULL AS VARCHAR(40)) AS CAUSALE
,CAST(NULL AS VARCHAR(15)) AS CAUSALECANTIERE
,CAST(0 AS DECIMAL(15,4)) AS RITENUTAACCONTO
,CAST(Cli.ClienteFornitore AS VARCHAR(10)) AS TIPOSOGGETTO
,CAST('' AS VARCHAR(10)) AS OPERATORE
,CAST('' AS VARCHAR(10)) AS OPERATOREULTMOD_ULTMOD
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_CREAZIONE
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_ULTMOD
,CAST(Cli.RAGIONESOCIALE AS VARCHAR(60)) AS RAGSOCCLI
,CAST(NULL AS VARCHAR(60)) AS RAGSOCDESTMERCI
,CAST(Doc.SOGGETTO AS INTEGER) AS CODICECLIENTE
,CAST(NULL AS INTEGER) AS RIFSOGG1_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG2_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG3_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG4_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG5_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG6_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG7_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG8_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG9_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG10_CODICE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG1_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG2_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG3_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG4_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG5_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG6_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG7_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG8_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG9_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG10_RAGIONESOCIALE
,CAST(Prat.CODICE AS INTEGER) AS PRATICA
,CAST(prat.DATAAPERTURA AS TIMESTAMP) AS DATAPRATICA1
,CAST(NULL AS INTEGER) AS PRATICA2
,CAST(NULL AS TIMESTAMP) AS DATAPRATICA2
,CAST(NULL AS INTEGER) AS PRATICA3
,CAST(NULL AS TIMESTAMP) AS DATAPRATICA3
,CAST(NULL AS VARCHAR(25)) AS AGENTE
,CAST(NULL AS VARCHAR(25)) AS AGENTE2
,CAST(NULL AS VARCHAR(25)) AS AGENTE3
,CAST(NULL AS VARCHAR(25)) AS AGENTE4
,CAST(NULL AS CHAR(1)) AS AZIONECANTIERE
,CAST(NULL AS CHAR(1)) AS AZIONEMAGAZZINO
,CAST(NULL AS CHAR(1)) AS EXPORTED
,CAST(NULL AS INTEGER) AS PROTOCOLLO
,CAST(NULL AS TIMESTAMP) AS PROTOCOLLO
,PRAT.CATEGCANT1
,PRAT.CATEGCANT2
,PRAT.CATEGCANT3
,PRAT.CATEGCANT4
,PRAT.CATEGCANT5
,PRAT.CATEGCANT6
,CAST(NULL AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CAST(NULL AS INTEGER) AS CODICESUBSOGG
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO1
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO2
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO3
,CAST(NULL AS TIMESTAMP) AS SUBSOGGCAMPO4
,CAST(null AS VARCHAR(25)) AS RIFDOC_TIPO
,CAST(DOC.ID AS INTEGER) AS RIFDOC_NUM
,CAST(null AS VARCHAR(5)) AS RIFDOC_REG
,CAST(null AS TIMESTAMP) AS RIFDOC_DATA
,CAST(null AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CLI.PARTITAIVA
,CLI.CODICEFISCALE
,CAST('' AS VARCHAR(250)) AS DESTINAZIONEMERCI
,CAST('' AS VARCHAR(40)) AS PAGAMENTO
,CAST(NULL AS VARCHAR(250)) AS FE_ID
,CAST(NULL AS VARCHAR(30)) AS FE_STATUS
,CAST(NULL AS TIMESTAMP) AS FE_LASTNOTIFICATION
,CAST(NULL AS CHAR(1)) AS FE_CHECKFORNOTIFICATIONS
,CAST(NULL AS INTEGER) AS FE_NOTIFICATIONWAITDAYS
,CLI.TIPOPERSONA
,CAST(0 AS DECIMAL(15,4)) AS JOLLY_NUM_1
,CAST('' AS VARCHAR(255)) AS RESOURCENAME
,CAST(NULL AS VARCHAR(255)) AS APPARECCHI
,CAST(Doc.Tipo AS VARCHAR(25)) AS TIPODOCESTESO
,CAST(NULL AS VARCHAR(20)) AS RDA
,CAST(0 AS DECIMAL(15,4)) AS ABBUONO
,CAST(0 AS DECIMAL(15,4)) AS TOTALEDAPAGARE
,CAST(0 AS DECIMAL(15,4)) AS TOTALESPLITPAYMENT
,CAST(NULL AS VARCHAR(50)) AS DATIVETTORE
FROM LDE_DOCUMENTI Doc
LEFT JOIN CLIENTI CLI ON (CLI.CODICE = DOC.SOGGETTO)
LEFT JOIN PRATICHE PRAT ON (PRAT.ID=DOC.PRATICA)
/* ================================================== */
UNION ALL
/*======================================================
SEZIONE CONFORMITA (VECCHIE): CONFORM
======================================================*/
SELECT
 CAST(NULL AS INTEGER) AS ID
,CAST('F' AS CHAR(1)) AS IS_LDE
,CAST('Conformita' AS VARCHAR(20)) AS TIPODOC
,CAST('OLD' AS VARCHAR(5)) AS REGISTRO
,CAST(Doc.Codice AS INTEGER) AS CODICEDOC
,CAST(Doc.Data AS TIMESTAMP) AS DATADOC
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY1
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY2
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY3
,CAST(0 AS DECIMAL(15,4)) AS IMPORTO
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY1
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY2
,CAST(  SUBSTRING(  Cli.RagioneSociale || '  (' || Doc.Cliente || ')' FROM 1 FOR 80) AS VARCHAR(80)) AS CLIENTEFORNITORE
,CAST('' AS VARCHAR(5000)) AS OGGETTO
,CAST(Doc.Note AS VARCHAR(5000)) AS NOTE
,CAST('' AS VARCHAR(5000)) AS MESSAGGI
,CAST(Doc.StatoDescrizione AS VARCHAR(10)) AS STATODESCRIZIONE
,CAST(Doc.StatoForeground AS VARCHAR(10)) AS STATOFOREGROUND
,CAST(Doc.StatoBackground AS VARCHAR(10)) AS STATOBACKGROUND
,CAST('' AS VARCHAR(1)) AS SELEZIONATO
,CAST('' AS VARCHAR(200)) AS PROVENIENZA
,CAST('' AS VARCHAR(200)) AS ARGOMENTO
,CAST(0 AS DECIMAL(15,4)) AS IMPONIBILE
,CAST(0 AS DECIMAL(15,4)) AS IMPORTOIVA
,CAST(Doc.Cliente AS INTEGER) AS CODICESOGGETTO
,CAST('' AS VARCHAR(8)) AS ORADOC
,CAST('' AS VARCHAR(1)) AS DAFATTURARE
,CAST(  SUBSTRING(  PRAT.DESCRIZIONE ||'  ('||DOC.PRATICA|| ', '||DOC.DATAPRATICA1||')'  FROM 1 FOR 120) AS VARCHAR(120)) AS RIFPRATICA
,CAST(NULL AS TIMESTAMP) AS VALIDITADATA
,CAST(NULL AS TIMESTAMP) AS CONSEGNADATA
,CAST(NULL AS CHAR(1)) AS CONSEGNATO
,CAST(NULL AS VARCHAR(40)) AS CAUSALE
,CAST(NULL AS VARCHAR(15)) AS CAUSALECANTIERE
,CAST(0 AS DECIMAL(15,4)) AS RITENUTAACCONTO
,CAST(Cli.ClienteFornitore AS VARCHAR(10)) AS TIPOSOGGETTO
,CAST('' AS VARCHAR(10)) AS OPERATORE
,CAST('' AS VARCHAR(10)) AS OPERATOREULTMOD_ULTMOD
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_CREAZIONE
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_ULTMOD
,CAST(Doc.RagSocCli AS VARCHAR(60)) AS RAGSOCCLI
,CAST(NULL AS VARCHAR(60)) AS RAGSOCDESTMERCI
,CAST(Doc.Cliente AS INTEGER) AS CODICECLIENTE
,CAST(NULL AS INTEGER) AS RIFSOGG1_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG2_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG3_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG4_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG5_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG6_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG7_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG8_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG9_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG10_CODICE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG1_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG2_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG3_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG4_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG5_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG6_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG7_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG8_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG9_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG10_RAGIONESOCIALE
,CAST(Doc.Pratica AS INTEGER) AS PRATICA
,CAST(Doc.DATAPRATICA1 AS TIMESTAMP) AS DATAPRATICA1
,CAST(Doc.Pratica2 AS INTEGER) AS PRATICA2
,CAST(Doc.DATAPRATICA2 AS TIMESTAMP) AS DATAPRATICA2
,CAST(Doc.Pratica3 AS INTEGER) AS PRATICA3
,CAST(Doc.DATAPRATICA3 AS TIMESTAMP) AS DATAPRATICA3
,CAST(NULL AS VARCHAR(25)) AS AGENTE
,CAST(NULL AS VARCHAR(25)) AS AGENTE2
,CAST(NULL AS VARCHAR(25)) AS AGENTE3
,CAST(NULL AS VARCHAR(25)) AS AGENTE4
,CAST(NULL AS CHAR(1)) AS AZIONECANTIERE
,CAST(NULL AS CHAR(1)) AS AZIONEMAGAZZINO
,CAST(NULL AS CHAR(1)) AS EXPORTED
,CAST(NULL AS INTEGER) AS PROTOCOLLO
,CAST(NULL AS TIMESTAMP) AS PROTOCOLLO
,PRAT.CATEGCANT1
,PRAT.CATEGCANT2
,PRAT.CATEGCANT3
,PRAT.CATEGCANT4
,PRAT.CATEGCANT5
,PRAT.CATEGCANT6
,CAST(NULL AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CAST(NULL AS INTEGER) AS CODICESUBSOGG
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO1
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO2
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO3
,CAST(NULL AS TIMESTAMP) AS SUBSOGGCAMPO4
,CAST(null AS VARCHAR(25)) AS RIFDOC_TIPO
,CAST(null AS INTEGER) AS RIFDOC_NUM
,CAST(null AS VARCHAR(5)) AS RIFDOC_REG
,CAST(null AS TIMESTAMP) AS RIFDOC_DATA
,CAST(null AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CLI.PARTITAIVA
,CLI.CODICEFISCALE
,CAST('' AS VARCHAR(250)) AS DESTINAZIONEMERCI
,CAST('' AS VARCHAR(40)) AS PAGAMENTO
,CAST(NULL AS VARCHAR(250)) AS FE_ID
,CAST(NULL AS VARCHAR(30)) AS FE_STATUS
,CAST(NULL AS TIMESTAMP) AS FE_LASTNOTIFICATION
,CAST(NULL AS CHAR(1)) AS FE_CHECKFORNOTIFICATIONS
,CAST(NULL AS INTEGER) AS FE_NOTIFICATIONWAITDAYS
,CLI.TIPOPERSONA
,CAST(0 AS DECIMAL(15,4)) AS JOLLY_NUM_1
,CAST('' AS VARCHAR(255)) AS RESOURCENAME
,CAST(NULL AS VARCHAR(255)) AS APPARECCHI
,CAST('Conformita' AS VARCHAR(25)) AS TIPODOCESTESO
,CAST(NULL AS VARCHAR(20)) AS RDA
,CAST(0 AS DECIMAL(15,4)) AS ABBUONO
,CAST(0 AS DECIMAL(15,4)) AS TOTALEDAPAGARE
,CAST(0 AS DECIMAL(15,4)) AS TOTALESPLITPAYMENT
,CAST(NULL AS VARCHAR(50)) AS DATIVETTORE
FROM Conform Doc
LEFT JOIN CLIENTI CLI ON (CLI.CODICE = DOC.CLIENTE)
LEFT JOIN PRATICHE PRAT ON (PRAT.CODICE=DOC.PRATICA AND PRAT.DATAAPERTURA=DOC.DATAPRATICA1)
/* ================================================== */
UNION ALL
/*======================================================
SEZIONE RAPPORTI GIORNALIERI: RAPGIORN
======================================================*/
SELECT
 CAST(NULL AS INTEGER) AS ID
,CAST('F' AS CHAR(1)) AS IS_LDE
,CAST('Rapp.giorn.' AS VARCHAR(20)) AS TIPODOC
,CAST(Doc.Registro AS VARCHAR(5)) AS REGISTRO
,CAST(Doc.NumDoc AS INTEGER) AS CODICEDOC
,CAST(Doc.DataDoc AS TIMESTAMP) AS DATADOC
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY1
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY2
,CAST('' AS VARCHAR(30)) AS OGGETTOJOLLY3
,CAST(0 AS DECIMAL(15,4)) AS IMPORTO
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY1
,CAST('' AS VARCHAR(30)) AS NOTEJOLLY2
,CAST(  SUBSTRING(  Cli.RagioneSociale || '  (' || Doc.CodiceCliente || ')' FROM 1 FOR 80) AS VARCHAR(80)) AS CLIENTEFORNITORE
,CAST('' AS VARCHAR(5000)) AS OGGETTO
,CAST('' AS VARCHAR(5000)) AS NOTE
,CAST('' AS VARCHAR(5000)) AS MESSAGGI
,CAST(Doc.StatoDescrizione AS VARCHAR(10)) AS STATODESCRIZIONE
,CAST(Doc.StatoForeground AS VARCHAR(10)) AS STATOFOREGROUND
,CAST(Doc.StatoBackground AS VARCHAR(10)) AS STATOBACKGROUND
,CAST('' AS VARCHAR(1)) AS SELEZIONATO
,CAST('' AS VARCHAR(200)) AS PROVENIENZA
,CAST('' AS VARCHAR(200)) AS ARGOMENTO
,CAST(0 AS DECIMAL(15,4)) AS IMPONIBILE
,CAST(0 AS DECIMAL(15,4)) AS IMPORTOIVA
,CAST(Doc.CodiceCliente AS INTEGER) AS CODICESOGGETTO
,CAST('' AS VARCHAR(8)) AS ORADOC
,CAST('' AS VARCHAR(1)) AS DAFATTURARE
,CAST(  SUBSTRING(  PRAT.DESCRIZIONE ||'  ('||DOC.PRATICA|| ', '||DOC.DATAPRATICA1||')' FROM 1 FOR 120) AS VARCHAR(120)) AS RIFPRATICA
,CAST(NULL AS TIMESTAMP) AS VALIDITADATA
,CAST(NULL AS TIMESTAMP) AS CONSEGNADATA
,CAST(NULL AS CHAR(1)) AS CONSEGNATO
,CAST(NULL AS VARCHAR(40)) AS CAUSALE
,CAST(NULL AS VARCHAR(15)) AS CAUSALECANTIERE
,CAST(0 AS DECIMAL(15,4)) AS RITENUTAACCONTO
,CAST(Cli.ClienteFornitore AS VARCHAR(10)) AS TIPOSOGGETTO
,CAST('' AS VARCHAR(10)) AS OPERATORE
,CAST('' AS VARCHAR(10)) AS OPERATOREULTMOD_ULTMOD
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_CREAZIONE
,CAST(NULL AS TIMESTAMP) AS DATAULTMOD_ULTMOD
,CAST(Doc.RagSocCli AS VARCHAR(60)) AS RAGSOCCLI
,CAST(NULL AS VARCHAR(60)) AS RAGSOCDESTMERCI
,CAST(Doc.CodiceCliente AS INTEGER) AS CODICECLIENTE
,CAST(NULL AS INTEGER) AS RIFSOGG1_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG2_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG3_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG4_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG5_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG6_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG7_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG8_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG9_CODICE
,CAST(NULL AS INTEGER) AS RIFSOGG10_CODICE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG1_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG2_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG3_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG4_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG5_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG6_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG7_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG8_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG9_RAGIONESOCIALE
,CAST(NULL AS VARCHAR(60)) AS RIFSOGG10_RAGIONESOCIALE
,CAST(Doc.Pratica AS INTEGER) AS PRATICA
,CAST(Doc.DATAPRATICA1 AS TIMESTAMP) AS DATAPRATICA1
,CAST(NULL AS INTEGER) AS PRATICA2
,CAST(NULL AS TIMESTAMP) AS DATAPRATICA2
,CAST(NULL AS INTEGER) AS PRATICA3
,CAST(NULL AS TIMESTAMP) AS DATAPRATICA3
,CAST(Doc.AGENTE AS VARCHAR(25)) AS AGENTE
,CAST(Doc.AGENTE2 AS VARCHAR(25)) AS AGENTE2
,CAST(Doc.AGENTE3 AS VARCHAR(25)) AS AGENTE3
,CAST(Doc.AGENTE4 AS VARCHAR(25)) AS AGENTE4
,CAST(NULL AS CHAR(1)) AS AZIONECANTIERE
,CAST(NULL AS CHAR(1)) AS AZIONEMAGAZZINO
,CAST(NULL AS CHAR(1)) AS EXPORTED
,CAST(NULL AS INTEGER) AS PROTOCOLLO
,CAST(NULL AS TIMESTAMP) AS PROTOCOLLO
,PRAT.CATEGCANT1
,PRAT.CATEGCANT2
,PRAT.CATEGCANT3
,PRAT.CATEGCANT4
,PRAT.CATEGCANT5
,PRAT.CATEGCANT6
,CAST(NULL AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CAST(NULL AS INTEGER) AS CODICESUBSOGG
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO1
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO2
,CAST(NULL AS VARCHAR(30)) AS SUBSOGGCAMPO3
,CAST(NULL AS TIMESTAMP) AS SUBSOGGCAMPO4
,CAST(null AS VARCHAR(25)) AS RIFDOC_TIPO
,CAST(null AS INTEGER) AS RIFDOC_NUM
,CAST(null AS VARCHAR(5)) AS RIFDOC_REG
,CAST(null AS TIMESTAMP) AS RIFDOC_DATA
,CAST(null AS CHAR(1)) AS RIFDOC_CORRISPNOPAG
,CLI.PARTITAIVA
,CLI.CODICEFISCALE
,CAST('' AS VARCHAR(250)) AS DESTINAZIONEMERCI
,CAST('' AS VARCHAR(40)) AS PAGAMENTO
,CAST(NULL AS VARCHAR(250)) AS FE_ID
,CAST(NULL AS VARCHAR(30)) AS FE_STATUS
,CAST(NULL AS TIMESTAMP) AS FE_LASTNOTIFICATION
,CAST(NULL AS CHAR(1)) AS FE_CHECKFORNOTIFICATIONS
,CAST(NULL AS INTEGER) AS FE_NOTIFICATIONWAITDAYS
,CLI.TIPOPERSONA
,CAST(0 AS DECIMAL(15,4)) AS JOLLY_NUM_1
,CAST('' AS VARCHAR(255)) AS RESOURCENAME
,CAST(NULL AS VARCHAR(255)) AS APPARECCHI
,CAST('Rapportino' AS VARCHAR(25)) AS TIPODOCESTESO
,CAST(NULL AS VARCHAR(20)) AS RDA
,CAST(0 AS DECIMAL(15,4)) AS ABBUONO
,CAST(0 AS DECIMAL(15,4)) AS TOTALEDAPAGARE
,CAST(0 AS DECIMAL(15,4)) AS TOTALESPLITPAYMENT
,CAST(NULL AS VARCHAR(50)) AS DATIVETTORE
FROM RapGiorn Doc
LEFT JOIN CLIENTI CLI ON (CLI.CODICE = DOC.CODICECLIENTE)
LEFT JOIN PRATICHE PRAT ON (PRAT.CODICE=DOC.PRATICA AND PRAT.DATAAPERTURA=DOC.DATAPRATICA1)
/* ================================================== */
;