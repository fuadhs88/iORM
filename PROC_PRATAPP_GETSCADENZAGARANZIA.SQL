SET TERM ^ ;

CREATE PROCEDURE PRATAPP_GETSCADENZAGARANZIA (IN_ID_PRATAPP INTEGER, IN_GAR_MESI SMALLINT, IN_DATAPARTENZA TIMESTAMP)
  RETURNS (OUTVAR TIMESTAMP)
AS BEGIN

  /* Inizializzazione */
  OUTVAR = NULL;

  /* Verifica la validità dei parametri ricevuti */
  IF (IN_ID_PRATAPP IS NULL OR COALESCE(IN_GAR_MESI,0)=0 OR IN_DATAPARTENZA IS NULL) THEN BEGIN
    SUSPEND;
    EXIT;
  END

  /* Calcola la data di scadenza */
  OUTVAR = ADDMONTH(IN_DATAPARTENZA, IN_GAR_MESI);
  OUTVAR = ADDDAY(OUTVAR, (-1));

  /* Esce */
  SUSPEND;
  EXIT;
 
END^

SET TERM ; ^
